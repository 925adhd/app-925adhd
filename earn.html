<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Earn</title>
  
  <!-- PWA Meta Tags -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#56C3AE">
  <style id="layout-temp-style">
    body:not(.has-site-layout) .top-header,
    body:not(.has-site-layout) .header,
    body:not(.has-site-layout) .bottom-nav,
    body:not(.has-site-layout) .page-nav,
    body:not(.has-site-layout) header:not(.site-header),
    body:not(.has-site-layout) nav:not(.site-nav),
    .back-btn, .back-button, button.back, a.back, .btn-back, .back, .back-arrow, .back-arrow-btn, .page-back, button[aria-label="Back"], .menu-btn { display: none !important; }
  </style>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="925 ADHD">
  <link rel="apple-touch-icon" href="https://img1.wsimg.com/isteam/ip/e5c52ac6-7189-421d-9701-bbc6d6a027fc/SmartSelect_20241218_055052_Gallery.png">
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="https://img1.wsimg.com/isteam/ip/e5c52ac6-7189-421d-9701-bbc6d6a027fc/SmartSelect_20241218_055052_Gallery.png">
  <style>
    :root {
      --bg: #0f0f0f;
      --card: #1a1a1a;
      --card-hover: #222;
      --text: #ffffff;
      --text-muted: #888;
      --brand: #56C3AE;
      --brand-glow: rgba(86, 195, 174, 0.3);
      --green: #22c55e;
      --yellow: #facc15;
      --orange: #f97316;
      --red: #ef4444;
      --blue: #3b82f6;
      --pink: #ec4899;
      --purple: #a855f7;
    }
    
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      padding-bottom: 90px;
      -webkit-font-smoothing: antialiased;
    }
    
    /* Header */
    
    .header h1 {
      font-size: 18px;
      font-weight: 700;
      color: #0F0F0F;
    }
    
    main {
      padding: 20px 16px;
      max-width: 700px;
      margin: 0 auto;
    }
    
    .updated-badge {
      color: var(--text-muted);
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
      opacity: 0.9;
    }
    
    /* Energy Selector - The key ADHD feature */
    .energy-section {
      /* Main panel behind the energy selector */
      background: linear-gradient(180deg,#0f1116,#0b0d12);
      border:1px solid rgba(255,255,255,.06);
      border-radius:16px;
      padding:18px 14px 36px; /* increased bottom padding for more breathing room */
      margin-bottom:40px; /* larger gap before the search bar */
      box-shadow:0 6px 18px rgba(0,0,0,.28);
    }
    
    .energy-label {
      font-size: 13px;
      font-weight: 700;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 6px;
      color: var(--brand);
    }
    
    .energy-wrap{
      padding:0;
      border-radius:12px;
      background:transparent; /* moved main background to .energy-section */
      border:0;
      box-shadow:none;
    }

    .energy-title{
      margin:0 0 12px;
      font-weight:800;
      letter-spacing:.2px;
      color:#eaf2ff;
    }

    .energy-grid{
      display: grid !important;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }

    .energy-card{
      display:flex;
      align-items:center;
      gap:12px;
      padding:6px 0 18px; /* increased bottom padding to add space below battery */
      border-radius:0;
      background:transparent; /* remove card background */
      border:0;
      color:#eaf2ff;
      cursor:pointer;
      transition:transform .10s ease;
      user-select:none;
    }

    .energy-card:hover{
      transform:translateY(-2px);
    }

    .energy-card:active{ transform:translateY(0); }

    .energy-card:focus-visible{
      outline:none;
      box-shadow:0 0 0 3px rgba(130,190,255,.12);
    }

    .energy-card[aria-pressed="true"]{
      background: transparent;
      border: none;
    }

    .energy-label{font-weight:800;line-height:1.1}

    .energy-sub{font-size:12px;opacity:.75;margin-top:2px}

    /* Battery buddy (icon) */
    .battery{
      --fill:50%;
      --c1: rgba(80,200,120,.95);
      --c2: rgba(80,200,120,.55);

      position:relative;
      flex:0 0 auto;
      width:52px;
      height:26px;
      border-radius:8px;
      border:2px solid rgba(255,255,255,.32);
      background:rgba(0,0,0,.25);
      box-shadow:inset 0 0 0 1px rgba(0,0,0,.45), inset 0 10px 18px rgba(255,255,255,.06);
      overflow:hidden;
    }

    .battery::after{content:"";position:absolute;left:2px;right:2px;top:2px;height:40%;border-radius:6px;background:linear-gradient(180deg, rgba(255,255,255,.16), rgba(255,255,255,0));pointer-events:none}

    .battery-cap{position:absolute;right:-7px;top:7px;width:8px;height:12px;border-radius:3px;background:rgba(255,255,255,.30);box-shadow:inset 0 0 0 1px rgba(0,0,0,.35)}

    .battery-fill{position:absolute;inset:0 auto 0 0;width:var(--fill);border-radius:6px;background:linear-gradient(90deg, var(--c1), var(--c2));box-shadow:inset 0 0 0 1px rgba(0,0,0,.25);transition:width .22s ease}

    /* segmented look */
    .battery-bars{position:absolute;inset:3px 3px 3px 3px;border-radius:6px;pointer-events:none;background:repeating-linear-gradient(90deg, rgba(0,0,0,.20) 0 8px, rgba(255,255,255,.08) 8px 9px);mix-blend-mode:overlay;opacity:.55}

    /* hide tiny face elements on battery icons */
    .battery-face, .battery-mouth{display:none !important}

    .energy-card[data-level="low"] .battery{--c1: rgba(255,90,90,.95);--c2: rgba(255,90,90,.55)}
    .energy-card[data-level="low"] .battery-mouth{height:0;border:0;width:10px;border-top:2px solid rgba(0,0,0,.55);border-radius:10px;top:7px}

    /* swapped: ok -> warm (yellow), hyper -> green */
    .energy-card[data-level="ok"] .battery{--c1: rgba(255,190,70,.98);--c2: rgba(255,190,70,.58)}

    .energy-card[data-level="hyper"] .battery{--c1: rgba(80,200,120,.95);--c2: rgba(80,200,120,.55)}
    .energy-card[data-level="hyper"] .battery-mouth{width:14px;height:7px;top:5px}

    /* compact duplicate .battery removed (kept expanded readable definition above) */

    .energy-card[aria-pressed="true"] .battery{
      box-shadow: 0 0 20px 8px rgba(86, 195, 174, 0.4);
      transform: translateY(-2px) scale(1.04);
    }
    .energy-card[aria-pressed="true"] .energy-label{
      color: var(--brand);
      text-shadow: 0 8px 30px rgba(86,195,174,0.6), 0 0 10px rgba(86,195,174,0.45);
      transform: translateY(-1px) scale(1.02);
      transition: color .18s ease, text-shadow .18s ease, transform .18s ease;
      font-weight: 800;
    }

    @media (max-width:720px){
      .energy-grid{
        display:flex;
        gap:10px;
        flex-wrap:wrap;
        padding-bottom:0;
      }
      .energy-card{flex:1 1 0;min-width:0}
    }
    
    /* Quick Filters (moved into dropdown) */
    .filter-row {
      display: none; /* chips replaced by dropdown filter */
    }

    .filter-select {
      appearance: none;
      -webkit-appearance: none;
      background: var(--card);
      color: var(--text-muted);
      border: 1px solid rgba(255,255,255,0.08);
      padding: 8px 12px;
      border-radius: 10px;
      font-weight: 600;
      font-size: 13px;
      cursor: pointer;
    }

    .results-controls {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    
    /* Search */
    .search-box {
      position: relative;
      margin-bottom: 16px;
    }
    
    .search-box input {
      width: 100%;
      padding: 14px 16px 14px 44px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.1);
      background: var(--card);
      color: var(--text);
      font-size: 15px;
      outline: none;
      transition: border-color 0.2s;
    }
    
    .search-box input:focus {
      border-color: var(--brand);
    }
    
    .search-box input::placeholder {
      color: var(--text-muted);
    }
    
    .search-box::before {
      content: "üîç";
      position: absolute;
      left: 14px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 16px;
    }

    /* Category Tabs (mobile-friendly horizontal scroller) */
    .category-wrap { position: relative; }
    .category-tabs {
      display: flex;
      gap: 8px;
      margin: 12px 0 18px;
      overflow-x: auto;
      /* left-aligned: small left padding, larger right padding for scroll-right arrow */
      padding: 6px 56px 6px 12px;
      -webkit-overflow-scrolling: touch;
      scroll-behavior: smooth;
      /* Reserve space immediately to avoid layout shifts when JS populates tabs */
      min-height: 44px;
      transition: none; /* disable transition so tabs are present instantly */
    }
    .category-tabs::-webkit-scrollbar { display: none; }
    .tab-btn {
      background: var(--card);
      border: 1px solid rgba(255,255,255,0.06);
      color: var(--text-muted);
      padding: 8px 14px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 700;
      cursor: pointer;
      white-space: nowrap;
    }
    .tab-btn:hover { border-color: var(--brand); color: var(--text); }
    .tab-btn.active { background: var(--brand); color: #0F0F0F; border-color: var(--brand); }

    /* Desktop arrows for category scroller */
    .cat-scroll-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 32px;
      height: 32px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.06);
      background: rgba(0,0,0,0.35);
      color: var(--text);
      display: none; /* shown on desktop */
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 5;
      backdrop-filter: blur(4px);
    }
    .cat-scroll-btn.left { left: 6px; }
    .cat-scroll-btn.right { right: 6px; }

    /* Show arrow controls on larger screens */
    @media (min-width: 720px) {
      .cat-scroll-btn { display: flex; }
      /* keep left padding small on desktop so tabs start at left edge */
      .category-tabs { padding: 6px 56px 6px 12px; }
    }
    
    /* Pro Tip */
    .pro-tip {
      background: linear-gradient(135deg, rgba(168,85,247,0.15), rgba(236,72,153,0.1));
      border: 1px solid rgba(168,85,247,0.3);
      border-radius: 12px;
      padding: 12px 14px;
      margin-bottom: 16px;
      font-size: 13px;
      line-height: 1.5;
      /* Fixed height to prevent layout shifts when tips rotate. */
      height: calc(1.5em * 3 + 24px);
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      /* Non-standard flag in some editors; provide progressive fallback */
      line-clamp: 3;
      max-height: calc(1.5em * 3);
      text-overflow: ellipsis;
    }
    
    .pro-tip strong {
      color: var(--purple);
    }
    /* Make pro-tip expand on small screens so text isn't clipped */
    @media (max-width: 480px) {
      .pro-tip {
        height: auto !important;
        max-height: none !important;
        overflow: visible !important;
        display: block !important;
        -webkit-line-clamp: unset !important;
        line-clamp: unset !important;
        font-size: 12px;
        padding: 10px 12px;
      }
    }
    
    /* Results bar + filter UI */
    .results-bar { display:flex; align-items:flex-start; justify-content:space-between; gap:10px; margin:10px 0 14px; flex-wrap: nowrap; flex-direction: column; }
    .results-controls { order: 1; width: 100%; display: flex; align-items: center; justify-content: flex-start; gap: 8px; min-width: 0; }
    .results-text { order: 2; font-size:14px; color:var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; width: 100%; margin-top: 8px; }
    .results-controls { display:flex; align-items:center; gap:10px; }

    .filter { position: relative; display: inline-flex; align-items: center; gap: 8px; }

    .filter-pill{ display:flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.10); background: rgba(255,255,255,.04); color:#fff; cursor:pointer; box-shadow: 0 6px 16px rgba(0,0,0,.28); font-size:13px; }
    .filter-label {
      font-size: 13px;
      color: var(--brand);
      display: inline-flex;
      align-items: center;
      gap: 6px; /* tightened spacing to match text */
      font-weight: 700;
      background: transparent;
      border: 0;
      padding: 6px 8px;
      border-radius: 8px;
      cursor: pointer;
    }
    .filter-icon{
      width:14px; /* smaller to better fit text */
      height:10px;
      color:var(--brand);
      flex: none;
      display:inline-block;
      vertical-align:middle;
    }
    .filter-text{ display:inline-block }
    .filter-value{ font-weight:600; display:flex; align-items:center; gap:8px; color: var(--text); }
    /* hide chevrons for inline chips (we show plain pills) */
    .chev{ display: none !important; color: var(--text); opacity:.95; margin-left:4px; font-size:12px; }
     /* category scroller arrows: default hidden on small screens; shown on wide screens via media query
       JS will toggle their inline `style.display` to 'flex' when the tabs overflow */
     /* leave control to CSS media query + JS (no !important) */

    .pill-x{ width:34px; height:34px; border-radius:999px; border:1px solid rgba(255,255,255,.10); background: rgba(255,255,255,.04); color:#fff; cursor:pointer; display:grid; place-items:center; line-height:1; font-size:18px; }
    .pill-x:hover, .filter-pill:hover{ background: rgba(255,255,255,.07); border-color: rgba(255,255,255,.16); }

    .filter-menu{
      /* render chips inline (like apps.html) */
      position: static;
      right: auto;
      top: auto;
      width: auto;
      padding: 0;
      border-radius: 0;
      border: none;
      background: transparent;
      backdrop-filter: none;
      box-shadow: none;
      z-index: auto;

      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:center;
    }
    .filter-menu.hidden { display: flex !important; }
    .menu-item{ width:100%; display:flex; align-items:center; gap:10px; padding: 12px 12px; border-radius: 12px; border:0; background: transparent; color:#fff; cursor:pointer; text-align:left; font-weight:600; }
    .menu-item .icon{ width:20px; text-align:center; opacity:.9; }
    .menu-item:hover{ background: rgba(255,255,255,.07); }
    .menu-item.is-active{ background: rgba(255,255,255,.10); }

    /* Tag chips inside the Tags popover ‚Äî match card tag styling */
    .tag-chip{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:6px 8px;
      border-radius: 999px;
      white-space: nowrap;
      line-height: 1;
      font-size: 11px;
      font-weight: 800;
      cursor: pointer;
      flex: 0 0 auto;
    }
    .tag-chip:focus{ outline: none; box-shadow: 0 0 0 3px rgba(86,195,174,0.12); }
    .tag-chip.active{ background: var(--brand); color:#0F0F0F; border-color: var(--brand); }

    /* specific color variants to match .tag.* classes used in cards */
    .tag-chip.quick { background: rgba(90,195,174,0.12); color: #22d3ee; border-color: rgba(90,195,174,0.14); }
    .tag-chip.highpay { background: rgba(251,191,36,0.12); color: #fbbf24; border-color: rgba(251,191,36,0.14); }
    .tag-chip.beginner { background: rgba(255,255,255,0.03); color: var(--text); border-color: rgba(255,255,255,0.04); }
    .tag-chip.favorites { background: rgba(236,72,153,0.12); color: #f472b6; border-color: rgba(236,72,153,0.14); }
    .tag-chip.gift { background: rgba(251,191,36,0.12); color: #fbbf24; border-color: rgba(251,191,36,0.14); }

    .hidden{ display:none !important; }
    
    /* Category Headers */
    .category-header {
      font-size: 15px;
      font-weight: 700;
      margin: 20px 0 12px;
      color: var(--brand);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .category-header:first-of-type {
      margin-top: 0;
    }
    
    .category-count {
      font-size: 11px;
      color: var(--text-muted);
      font-weight: 500;
    }
    
    /* Gig Cards */
    .gig-grid {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .gig-card {
      display: flex;
      gap: 12px;
      padding: 14px;
      background: var(--card);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 14px;
      text-decoration: none;
      color: inherit;
      transition: all 0.2s ease;
      position: relative;
    }
    
    .gig-card:hover {
      background: var(--card-hover);
      border-color: var(--brand);
      transform: translateY(-1px);
    }
    
    .gig-card.favorite {
      border-color: rgba(236, 72, 153, 0.4);
    }
    
    .gig-logo {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      object-fit: cover;
      background: #2a2a2a;
      flex-shrink: 0;
    }
    
    .gig-content {
      flex: 1;
      min-width: 0;
    }
    
    .gig-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 8px;
    }
    
    .gig-name {
      font-size: 14px;
      font-weight: 700;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .fav-btn {
      background: none;
      border: none;
      font-size: 18px;
      cursor: pointer;
      padding: 0;
      line-height: 1;
      opacity: 0.7;
      transition: opacity 0.15s, transform 0.15s;
    }
    
    .fav-btn:hover {
      opacity: 1;
      transform: scale(1.1);
    }
    
    .fav-btn.active {
      opacity: 1;
    }
    
    .gig-rate {
      font-size: 13px;
      font-weight: 700;
      color: var(--green);
      margin: 2px 0;
    }
    
    .gig-desc {
      font-size: 12px;
      color: var(--text-muted);
      line-height: 1.4;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      /* fallback for non-WebKit browsers */
      line-clamp: 2;
      max-height: calc(1.4em * 2);
      overflow: hidden;
    }
    
    .gig-tags {
      display: flex;
      flex-wrap: nowrap;
      gap: 6px;
      margin-top: 6px;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      padding-bottom: 4px;
    }

    .gig-tags::-webkit-scrollbar { display: none; }

    .tag { white-space: nowrap; }

    .tag {
      font-size: 9px;
      font-weight: 600;
      padding: 2px 6px;
      border-radius: 6px;
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }

    /* Hide visible energy level tags while keeping underlying data and logic intact */
    .tag.energy-low,
    .tag.energy-med,
    .tag.energy-high {
      display: none !important;
      visibility: hidden !important;
      width: 0 !important;
      height: 0 !important;
      margin: 0 !important;
      padding: 0 !important;
      border: 0 !important;
    }

    /* Smaller filter chips used in header */
    .filter-chip{ display:inline-flex; align-items:center; gap:6px; padding:6px 8px; border-radius:999px; font-size:12px; font-weight:700; border:1px solid rgba(255,255,255,0.06); background: transparent; color:var(--text); cursor:pointer; white-space:nowrap; flex:0 0 auto; }

    /* Keep filter chips and tag chips on a single line; allow horizontal scroll when needed */
    .filter-row, .filter-menu { flex-wrap: nowrap; overflow-x: auto; -webkit-overflow-scrolling: touch; gap:6px; }
    .filter-row::-webkit-scrollbar, .filter-menu::-webkit-scrollbar, .gig-tags::-webkit-scrollbar { display: none; }
    
    .tag.energy-low { background: rgba(34,197,94,0.2); color: #4ade80; }
    .tag.energy-med { background: rgba(250,204,21,0.2); color: #fde047; }
    .tag.energy-high { background: rgba(249,115,22,0.2); color: #fb923c; }
    .tag.quick { background: rgba(90,195,174,0.2); color: #22d3ee; }
    .tag.browser { background: rgba(139,92,246,0.2); color: #a78bfa; }
    .tag.fave { background: rgba(236,72,153,0.2); color: #f472b6; }
    .tag.gift { background: rgba(251,191,36,0.2); color: #fbbf24; }
    
    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 48px 20px;
      color: var(--text-muted);
    }
    
    .empty-state .icon {
      font-size: 48px;
      margin-bottom: 12px;
    }
    
    .empty-state p {
      font-size: 14px;
      margin-bottom: 16px;
    }
    
    /* Bottom Nav */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #1a1a1a;
      border-top: 1px solid rgba(255,255,255,0.06);
      padding: 8px 0;
      padding-bottom: max(8px, env(safe-area-inset-bottom));
      z-index: 100;
    }
    
    .nav-items {
      display: flex;
      justify-content: space-around;
      max-width: 500px;
      margin: 0 auto;
    }
    
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      padding: 4px 12px;
      color: var(--text-muted);
      font-size: 10px;
      font-weight: 600;
      text-decoration: none;
      transition: color 0.15s;
    }
    
    .nav-item.active { color: var(--brand); }
    .nav-item .icon { font-size: 20px; }
    
    /* Utility */
    .hidden { display: none !important; }
    
    /* Key */
    .key-box {
      background: var(--card);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 10px;
      padding: 10px 14px;
      margin-bottom: 16px;
      font-size: 12px;
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      color: var(--text-muted);
    }
    
    .key-item {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    @media (max-width: 480px) {
      .filter-row { display: none; }
      .results-bar { gap: 6px; }
      .results-controls { gap: 4px; }
      .filter { gap: 4px; }
      .filter-pill { padding: 8px 10px; gap: 6px; }
      .filter-label { font-size: 12px; }
      .filter-value { font-size: 13px; }

      /* Center key items on small screens */
      .key-box { justify-content: center; text-align: center; }
      .key-item { justify-content: center; }
    }

    /* Loading screen */
    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      background: var(--bg);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      gap: 16px;
      z-index: 9999;
    }

    .spinner {
      width: 36px;
      height: 36px;
      border: 3px solid rgba(255, 255, 255, 0.1);
      border-top-color: var(--brand);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Hide page content initially */
    body:not(.loaded) .header,
    body:not(.loaded) main {
      display: none;
    }
  </style>
</head>
<body data-page-title="Earn">

  <!-- Loading screen -->
  <div id="loadingScreen" class="loading-screen">
    <div class="spinner"></div>
    <p style="color: var(--text-muted); font-size: 14px;">Loading...</p>
  </div>

  <!-- Header -->
  <header class="header">
    <div class="header-top">
      <a href="dashboard.html" class="back-btn">‚Üê</a>
      <h1>Earn</h1>
    </div>
  </header>

  <main>
    <p class="updated-badge">Updated January 2026</p>
    
    <!-- Energy Selector -->
    <div class="energy-wrap" role="group" aria-label="What's your energy level?">
      <p class="energy-title">Choose Your Energy Level</p>

      <div class="energy-grid">
        <button class="energy-card" data-level="low" type="button" aria-pressed="false">
          <div class="battery" style="--fill:18%">
            <div class="battery-fill"></div>
            <div class="battery-bars"></div>
            <div class="battery-face"><i></i><span class="battery-mouth"></span></div>
            <div class="battery-cap"></div>
          </div>
          <span class="energy-label">Low</span>
        </button>

        <button class="energy-card" data-level="ok" type="button" aria-pressed="false">
          <div class="battery" style="--fill:55%">
            <div class="battery-fill"></div>
            <div class="battery-bars"></div>
            <div class="battery-face"><i></i><span class="battery-mouth"></span></div>
            <div class="battery-cap"></div>
          </div>
          <span class="energy-label">Med</span>
        </button>

        <button class="energy-card" data-level="hyper" type="button" aria-pressed="false">
          <div class="battery" style="--fill:92%">
            <div class="battery-fill"></div>
            <div class="battery-bars"></div>
            <div class="battery-face"><i></i><span class="battery-mouth"></span></div>
            <div class="battery-cap"></div>
          </div>
          <span class="energy-label">High</span>
        </button>
      </div>

      <input type="hidden" id="batteryLevel" value="">
    </div>
    
    <!-- Quick Filters (moved to dropdown) -->
    <div class="filter-row" aria-hidden="true">
      <button class="filter-chip active" data-filter="all">All</button>
      <button class="filter-chip" data-filter="quick">‚ö° Fast</button>
      <button class="filter-chip" data-filter="highpay">üí∞ Top Pay</button>
      <button class="filter-chip" data-filter="beginner">üå± Easy</button>
      <button class="filter-chip" data-filter="favorites">ü•∞ Favorite</button>
    </div>
    
    <!-- Pro Tip -->
    <div class="pro-tip" id="proTip">
      <strong>üß† ADHD tip:</strong> Pick ONE option that fits your energy. Sign up while you‚Äôre motivated. Future you says thanks.
    </div>

    <!-- Search -->
    <div class="search-box">
      <input type="text" id="searchInput" placeholder="Search opportunities...">
    </div>
    <!-- Category tabs (apps-like) with desktop arrow controls -->
    <div class="category-wrap">
      <button type="button" id="catScrollLeft" class="cat-scroll-btn left" aria-hidden="true">‚óÄ</button>
      <div class="category-tabs" id="categoryTabs" aria-label="Categories"></div>
      <button type="button" id="catScrollRight" class="cat-scroll-btn right" aria-hidden="true">‚ñ∂</button>
    </div>
    
    <!-- Key removed per request -->
    
    <!-- Results Bar -->
    <div class="results-bar">
      <span id="resultsText">Showing 77 options</span>

      <div class="results-controls">
        <div class="filter" id="filter">
          <button class="filter-label" id="filterBtn" type="button" aria-haspopup="true" aria-expanded="false">
            
            <span class="filter-text">Tags</span>
          </button>

          <button class="pill-x hidden" id="clearBtn" type="button" aria-label="Clear filter">√ó</button>

          <div class="filter-menu" id="filterMenu" role="menu" aria-label="Tag filters">
            <button class="tag-chip quick" type="button" data-value="quick">‚ö° Fast</button>
            <button class="tag-chip highpay" type="button" data-value="highpay">üí∞ Top Pay</button>
            <button class="tag-chip beginner" type="button" data-value="beginner">üå± Easy</button>
            <button class="tag-chip favorites" type="button" data-value="favorites">ü•∞ Favorite</button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Initialization will happen at the end of the main script
    </script>
    
    <!-- Gig List -->
    <div class="gig-grid" id="gigGrid">
      <!-- Opportunities will be rendered here -->
    </div>
    
    <!-- Empty State -->
    <div class="empty-state hidden" id="emptyState">
      <div class="icon">üîç</div>
      <p>No opportunities match your filters</p>
      <button class="clear-filters" onclick="clearAllFilters()">Clear all filters</button>
    </div>
  </main>

  <!-- Bottom Nav -->
  <nav class="bottom-nav">
    <div class="nav-items">
      <a href="dashboard.html" class="nav-item">
        <span class="icon">üè†</span><span>Home</span>
      </a>
      <a href="guides.html" class="nav-item">
        <span class="icon">üìñ</span><span>Guides</span>
      </a>
      <a href="earn.html" class="nav-item active">
        <span class="icon">üí∞</span><span>Earn</span>
      </a>
      <a href="apps.html" class="nav-item">
        <span class="icon">üì±</span><span>Apps</span>
      </a>
      <a href="favorites.html" class="nav-item">
        <span class="icon">‚ù§Ô∏è</span><span>Saved</span>
      </a>
      <a href="tools.html" class="nav-item">
        <span class="icon">üõ†Ô∏è</span><span>Tools</span>
      </a>
    </div>
  </nav>

  <script>
    // ===== ALL 70 GIGS DATA =====
    const gigs = [
      // Fun or Interesting
      { id: "pressplay", name: "PressPlay", rate: "$0.60‚Äì$5/hr", desc: "Watch unreleased trailers & screenings for Amazon vouchers. Low pay but fun for movie fans.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/WUBBxNlrGzQLgbYSo2ns.png", link: "https://us.mypressplay.com", category: "fun", energy: "low", tags: ["beginner", "gift", "movies"], browser: false },
      { id: "slicethepie", name: "Slice The Pie", rate: "$1‚Äì$8/hr", desc: "Paid reviews on music, fashion, and commercials.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/N5HyBECr8SGscfvrXhHs.jpg", link: "https://www.slicethepie.com/", category: "fun", energy: "low", tags: ["beginner", "quick"], browser: false },
      { id: "methinks", name: "Methinks", rate: "$5‚Äì$100+/gig", desc: "Video interviews, app testing, and surveys for product research.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/alNW7pxDjaH7vy1c9gwt.png", link: "https://www.methinks.io/thinker", category: "surveys", energy: "med", tags: ["mobile","highpay"], browser: false },
      { id: "bestmark", name: "BestMark", rate: "$5‚Äì$25/shop", desc: "Mystery shopping assignments‚Äîvisit businesses undercover, report back, and get paid.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/xxx.png", link: "https://www.bestmark.com/become-a-mystery-shopper/", category: "fun", energy: "med", tags: ["in-person","mystery-shop"], browser: false },
      { id: "influenster", name: "Influenster", rate: "Free products", desc: "Test and review products through VoxBoxes; earn freebies, not cash.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/4A7UA3KtSXUkc9ueckJH.png", link: "https://www.influenster.com/", category: "fun", energy: "low", tags: ["beginner", "gift"], browser: false },
      
      // Surveys & Market Research
      { id: "prolific", name: "Prolific", rate: "$8‚Äì$18/hr", desc: "High-paying academic studies. Guaranteed minimum pay and PayPal cashouts.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/immy0sOGu8FJH0lgD7VN.png", link: "https://www.prolific.com/participants", category: "surveys", energy: "low", tags: ["beginner", "quick", "highpay", "academic"], browser: true, fave: true },
      { id: "dscout", name: "Dscout", rate: "$25‚Äì$250/mission", desc: "Video diaries, app testing, and live interviews for top brands.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/ir5Usfji0u0VtJf8iXTn.png", link: "https://dscout.com/participate-in-research-studies", category: "surveys", energy: "med", tags: ["highpay","mobile","video"], browser: false },
      { id: "respondentio", name: "Respondent.io", rate: "$50‚Äì$250+/study", desc: "High-paying research studies for professionals.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/tHrBfm7B9TRyDq7uZh73.png", link: "https://www.respondent.io/signup", category: "surveys", energy: "med", tags: ["highpay","professional"], browser: false },
      { id: "usertesting", name: "UserTesting", rate: "$10‚Äì$60/hr", desc: "Test websites and apps for bigger payouts. Share your screen and voice.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/THI1IS5clNzV8HIJ96gn.png", link: "https://www.usertesting.com/get-paid-to-test", category: "surveys", energy: "med", tags: ["highpay"], browser: false },
      // Playtesting & App Testing
      { id: "playtestcloud", name: "PlaytestCloud", rate: "$10‚Äì$50/hr", desc: "Paid playtests and prototype feedback for games and apps.", logo: "https://via.placeholder.com/150?text=PlaytestCloud", link: "https://playtestcloud.com/", category: "testing", energy: "med", tags: ["app-testing","games"], browser: false },
      { id: "trymata", name: "Trymata", rate: "$10‚Äì$60/hr", desc: "Unmoderated and moderated playtesting for apps and prototypes.", logo: "https://via.placeholder.com/150?text=Trymata", link: "https://trymata.com/", category: "testing", energy: "med", tags: ["app-testing"], browser: false },
      { id: "testbirds", name: "Testbirds", rate: "‚Ç¨10‚Äì‚Ç¨50/test", desc: "Find bugs and test websites/apps for ‚Ç¨10‚Äì‚Ç¨50 per test; ‚Ç¨1 per approved bug. EU-focused crowdtesting.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/xxx.png", link: "https://nest.testbirds.com/home", category: "testing", energy: "med", tags: ["app-testing","ux"], browser: false },

      // Microtask & Crowdsourcing Platforms
      { id: "mturk", name: "Amazon MTurk", rate: "$2‚Äì$6/hr avg", desc: "Amazon's massive microtask marketplace with endless small jobs; median earnings ~$2/hr, experienced workers $6‚Äì15/hr.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/xxx.png", link: "https://www.mturk.com/worker", category: "microtasks", energy: "low", tags: ["quick","beginner"], browser: false },
      { id: "lionbridge", name: "Lionbridge", rate: "$3‚Äì$20/hr", desc: "Language, search evaluation and AI data tasks from a major vendor.", logo: "https://via.placeholder.com/150?text=Lionbridge", link: "https://lionbridge.ai/", category: "ai", energy: "med", tags: ["ai","data-work"], browser: false },
      { id: "justanswer", name: "JustAnswer", rate: "$10‚Äì$50/hr", desc: "Answer questions as an expert for paid consultations and advice.", logo: "https://via.placeholder.com/150?text=JustAnswer", link: "https://www.justanswer.com/experts", category: "expert", energy: "high", tags: ["expert","consult"], browser: false },
      { id: "pineconeresearch", name: "Pinecone Research", rate: "$3‚Äì$12/hr", desc: "High payouts for surveys and product tests. Invite-only but worth it.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/bibC3v0lT4ryuYu9LMCr.png", link: "https://members.pineconeresearch.com/#/", category: "surveys", energy: "low", tags: ["beginner"], browser: false },
      { id: "surveyjunkie", name: "Survey Junkie", rate: "$1‚Äì$5/hr", desc: "Trusted, steady survey earnings. One of the most popular platforms.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/4sv9XSwPHs8dV9zETDsd.jpg", link: "https://www.surveyjunkie.com/", category: "surveys", energy: "low", tags: ["beginner", "quick"], browser: false },
      { id: "toluna", name: "Toluna", rate: "$3‚Äì$5/hr", desc: "Community-based surveys with polls, games, and discussions.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/El5li3CDmxyW2lFaPwyz.png", link: "https://www.toluna.com/home", category: "surveys", energy: "low", tags: ["beginner"], browser: false },
      { id: "lifepoints", name: "LifePoints", rate: "$1.50‚Äì$3/hr", desc: "Steady earnings from surveys. Mobile-friendly with 5M+ members.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/cAodh8wHqXuLW7PoRjgR.png", link: "https://www.lifepointspanel.com/", category: "surveys", energy: "low", tags: ["beginner", "quick"], browser: false },
      { id: "paidviewpoint", name: "Paid Viewpoint", rate: "$1‚Äì$3/hr", desc: "Short surveys, pays even if you don't finish. PayPal or Venmo.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/X4p6CA7iYfoM0LyEDUxQ.png", link: "https://paidviewpoint.com/", category: "surveys", energy: "low", tags: ["beginner", "quick"], browser: false },
      
      // AI Training & Data Work
      { id: "outlier", name: "Outlier", rate: "$15‚Äì$35/hr", desc: "Improve AI by rating responses, comparing outputs, and evaluating models.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/261LHUjlubG5IjYr0LZv.png", link: "https://outlier.ai", category: "ai", energy: "med", tags: ["highpay"], browser: false },
      { id: "appen", name: "Appen", rate: "$3‚Äì$14/hr", desc: "Specializes in AI training data with data labeling gigs.", logo: "https://cdn-images.himalayas.app/vmlva5ltollcahuby442urxngpau", link: "https://jobs.lever.co/appen", category: "ai", energy: "med", tags: ["beginner"], browser: false },
      { id: "clickworker", name: "Clickworker", rate: "$5‚Äì$12/hr", desc: "Freelance platform offering tasks like text creation & annotation.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/C1vyAjM6bkaR4bcNeCeA.png", link: "https://www.clickworker.com/clickworker/", category: "ai", energy: "med", tags: ["beginner", "quick"], browser: false },
      { id: "neevo", name: "Neevo", rate: "$5‚Äì$12/hr", desc: "Help improve AI by completing simple tasks involving text, audio, images.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/zbigllQ1z7hix1BDq2XT.png", link: "https://www.neevo.ai/", category: "ai", energy: "med", tags: ["beginner"], browser: false },
      
      // Mystery Shoppers
      { id: "bestmark", name: "BestMark", rate: "$10‚Äì$25/assignment", desc: "One of the biggest platforms for mystery shoppers with wide variety.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/M19p9QumhG9pef4jnC4G.jpg", link: "https://www.bestmark.com/become-a-mystery-shopper/", category: "mystery", energy: "med", tags: ["beginner"], browser: false },
      { id: "isecretshop", name: "iSecretShop", rate: "$5‚Äì$20/assignment", desc: "Flexible mystery shopping with mobile-friendly assignments.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/MUcOeiXW3P0e1CGmmUos.jpg", link: "https://www.isecretshop.com/register", category: "mystery", energy: "med", tags: ["beginner", "quick"], browser: false },
      { id: "marketforce", name: "Market Force", rate: "$5‚Äì$15/assignment", desc: "Earn by visiting locations and filling out surveys. Free food perks!", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/SxHLTnmhZ2kYE3ShRn4Y.png", link: "https://shopper.marketforce.com/#/login/newShopper/Apply", category: "mystery", energy: "med", tags: ["beginner"], browser: false },
      { id: "gigspot", name: "Gigspot", rate: "$5‚Äì$20/assignment", desc: "Hub for mystery shopping and evaluation gigs from multiple providers.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/PkdyJvLxQhLJzuLbbnAu.jpg", link: "https://www.gigspot.com/", category: "mystery", energy: "med", tags: ["beginner"], browser: false },
      { id: "prestoshopper", name: "Presto Shopper", rate: "$5‚Äì$15/assignment", desc: "Fast, map-based mystery shopping. Get paid same day!", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/DvyAgPosZi8eWjHhb77J.jpg", link: "https://insta.prestomobilesurveys.com/site", category: "mystery", energy: "med", tags: ["quick"], browser: false },
      
      // Transcription
      { id: "rev", name: "Rev", rate: "$10‚Äì$20/hr", desc: "Transcription, captions, and subtitles. Clients include Google & Amazon.", logo: "https://logosandtypes.com/wp-content/uploads/2022/04/Rev.png", link: "https://www.rev.com/freelancers", category: "transcription", energy: "high", tags: [], browser: false },
      { id: "transcribeme", name: "TranscribeMe", rate: "$15‚Äì$22/hr", desc: "Short audio clips (2-4 min) and flexible transcription tasks.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/6CTYiprr2sytaztxIqjN.jpg", link: "https://www.transcribeme.com/legal-transcriptionists-jobs/", category: "transcription", energy: "high", tags: ["highpay"], browser: false },
      { id: "gotranscript", name: "GoTranscript", rate: "$10‚Äì$20/hr", desc: "Transcribe audio & video in 40+ languages. Weekly PayPal payouts.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/2dkvf9pM4iw2a2GqOY2A.png", link: "https://gotranscript.com/transcription-jobs#apply-now", category: "transcription", energy: "high", tags: [], browser: false },
      { id: "scribie", name: "Scribie", rate: "$5‚Äì$15/hr", desc: "Transcription jobs for beginners. (Temporarily on hold)", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/LPDr1SXNANI6HXdPTP3K.jpg", link: "https://scribie.com/transcription/freelance", category: "transcription", energy: "high", tags: ["beginner"], browser: false },
      { id: "tigerfish", name: "Tigerfish", rate: "$5‚Äì$15/hr", desc: "High editorial standards. Interviews, focus groups, legal depositions.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/0a6l1YHXaIwBGINRrlEb.jpg", link: "https://tigerfish.com/transcription-jobs/", category: "transcription", energy: "high", tags: [], browser: false },
      { id: "castingwords", name: "CastingWords", rate: "$8‚Äì$12/hr", desc: "Flexible transcription with project choices. Weekly PayPal payouts.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/Vw2FEfsJFflaRP1c5VAk.png", link: "https://workshop.castingwords.com/", category: "transcription", energy: "high", tags: ["beginner"], browser: false },
      { id: "speechpad", name: "SpeechPad", rate: "$10‚Äì$25/hr", desc: "General, legal, and medical transcription. Twice-weekly pay!", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/SzYR5rgBweNs9sJ4811F.jpg", link: "https://www.speechpad.com/worker", category: "transcription", energy: "high", tags: ["highpay"], browser: false },
      { id: "quicktate", name: "Quicktate", rate: "$5‚Äì$10/hr", desc: "Short voicemails, medical and legal recordings. Quick tasks.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/uadmcUQtwAJA4ZC3LRHv.png", link: "https://typists.quicktate.com/transcribers/signup", category: "transcription", energy: "med", tags: ["quick"], browser: false },
      
      // Voice & Audio Work
      { id: "voices", name: "Voices", rate: "$200‚Äì$5,000+/project", desc: "Professional voice work for commercials, audiobooks, video games.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/wcEU9y1lRWTp9LrNAyMq.png", link: "https://www.voices.com/talent", category: "voice", energy: "high", tags: ["highpay"], browser: false },
      { id: "voice123", name: "Voice123", rate: "$100‚Äì$2,000+/project", desc: "Global voice marketplace. Set your own rates, no platform fees.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/jpwPeaMTIVCxow6FaQJY.png", link: "https://voice123.com/#how-to-search", category: "voice", energy: "high", tags: ["highpay"], browser: false },
      { id: "acx", name: "ACX (Amazon)", rate: "$200‚Äì$800+/hr", desc: "Audiobook narration for Audible. Royalty share options available!", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/3cyNkaHvJa798oxeZ7n0.jpg", link: "https://www.acx.com/mp/how-it-works/narrators-and-studios", category: "voice", energy: "high", tags: ["highpay"], browser: false },
      
      // Content Writing
      { id: "clearvoice", name: "ClearVoice", rate: "$100‚Äì$400+/article", desc: "Connect with brands for content. Clients come to you‚Äîno bidding.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/kRJCNp4S56RIYwZjvhWN.png", link: "https://clearvoice.com/signup", category: "writing", energy: "high", tags: ["highpay"], browser: false },
      { id: "scripted", name: "Scripted", rate: "$15‚Äì$50+/hr", desc: "Curated job board‚Äîpick gigs you want. No bidding wars.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/oHFDNcszl0MjisQF0KgJ.png", link: "https://www.scripted.com/become-a-scripted-writer", category: "writing", energy: "high", tags: ["highpay"], browser: false },
      { id: "writeraccess", name: "WriterAccess", rate: "$0.10‚Äì$1+/word", desc: "Star rating system‚Äîlevel up for better pay. 20K+ writers.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/jrkeq8izQRqzi3czUPvx.png", link: "https://www.writeraccess.com/talent-overview/", category: "writing", energy: "high", tags: [], browser: false },
      
      // Online Teaching
      { id: "wyzant", name: "Wyzant", rate: "$30‚Äì$100+/hr", desc: "Academic subjects & test prep. Premium rates, U.S. based.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/4CdttfiOOk3ESSjWBGO7.jpg", link: "https://www.wyzant.com/tutorsignupstart", category: "teaching", energy: "high", tags: ["highpay"], browser: false },
      { id: "preply", name: "Preply", rate: "$10‚Äì$40/hr", desc: "120+ subjects, global reach. Build ongoing student relationships.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/v0v44KBbRCrOhwJeveYj.png", link: "https://preply.com/en/teach", category: "teaching", energy: "high", tags: [], browser: false },
      { id: "italki", name: "iTalki", rate: "$5‚Äì$80/hr", desc: "Language tutoring focus. Only 15% commission!", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/rZ25jNe1Ex4MYF20nh15.png", link: "https://teach.italki.com/application", category: "teaching", energy: "high", tags: [], browser: false },
      { id: "cambly", name: "Cambly", rate: "$10‚Äì$12/hr", desc: "Casual English conversations. No lesson planning needed!", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/qghhXnqBdMEruH5bEWuL.png", link: "https://www.cambly.com/en/tutors?lang=en", category: "teaching", energy: "med", tags: ["beginner", "quick"], browser: false },
      
      // Virtual Assistant
      { id: "belaysolutions", name: "Belay Solutions", rate: "$15‚Äì$25/hr", desc: "US-based VAs, vetted professionals. Long-term remote careers.", logo: "https://media.licdn.com/dms/image/v2/D4E10AQHq0VJgaQKacA/image-shrink_800/image-shrink_800/0/1729178105794?e=2147483647&v=beta&t=9ly-pcP9eBsjgqN-2HEIdRa6hp99y98oJxR1z_ZfGnc", link: "https://belaysolutions.com/work-with-us/?=undefined", category: "va", energy: "high", tags: [], browser: false },
      { id: "timeetc", name: "Time Etc", rate: "$15‚Äì$30/hr", desc: "Established client relationships. US/UK only, part-time friendly.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/l5f859tQVXgDlX2aIqTN.png", link: "https://www.timeetc.com/work-for-us", category: "va", energy: "high", tags: [], browser: false },
      { id: "fancyhands", name: "Fancy Hands", rate: "$10‚Äì$15/hr", desc: "Quick, on-demand microtasks. Great for ADHD quick wins!", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/asHamvyp91UGgroT69Si.jpg", link: "https://www.fancyhands.com/jobs", category: "va", energy: "med", tags: ["quick", "beginner"], browser: false },
      
      // Freelancing Marketplaces
      { id: "toptal", name: "Toptal", rate: "$60‚Äì$150+/hr", desc: "Elite 3% acceptance. Premium clients, long-term contracts.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/z6xQQ7MZhH05Jephsdwo.png", link: "https://toptal.com/", category: "freelance", energy: "high", tags: ["highpay"], browser: false },
      { id: "fiverr", name: "Fiverr", rate: "$5‚Äì$500+/project", desc: "Gig-based marketplace. Clients come to you‚Äîno bidding!", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/Tji9gPHOWc8JX0Fr7lI6.png", link: "https://fiverr.com/", category: "freelance", energy: "high", tags: ["beginner"], browser: false },
      { id: "freelancer", name: "Freelancer", rate: "$10‚Äì$80+/hr", desc: "Competitive bidding platform. Huge variety of projects.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/zp6u2DdwP3cg0mFJxlSy.png", link: "https://freelancer.com/", category: "freelance", energy: "high", tags: [], browser: false },
      
      // Social Media Influencing
      { id: "youtube", name: "YouTube", rate: "$100‚Äì$50,000+/video", desc: "Video content. Ads, sponsorships, passive income potential.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/hIE0fwA9FyxSmGRkM0DU.png", link: "https://www.youtube.com/", category: "social", energy: "high", tags: ["highpay"], browser: false },
      { id: "tiktok", name: "TikTok", rate: "$50‚Äì$20,000+/post", desc: "Short-form video. Fast growth, viral potential.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/aUgg51uy2GH9tSe5bMN9.png", link: "https://www.tiktok.com/", category: "social", energy: "high", tags: ["highpay", "beginner"], browser: false },
      { id: "instagram", name: "Instagram", rate: "$200‚Äì$10,000+/post", desc: "Visual platform. Sponsored posts, affiliate links, ads.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/SHQ0QHgRlMhnXMFMaEhC.jpg", link: "https://www.instagram.com/", category: "social", energy: "high", tags: ["highpay"], browser: false },
      { id: "twitch", name: "Twitch", rate: "$50‚Äì$5,000+/stream", desc: "Live streaming. Subs, donations, sponsorships.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/aIgY0lJtG2Y2UqbbaZ1h.png", link: "https://www.twitch.tv/", category: "social", energy: "high", tags: ["highpay"], browser: false },
      { id: "patreon", name: "Patreon", rate: "$5‚Äì$5,000+/month", desc: "Fan memberships. Recurring income from supporters.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/ytr18NnJQrCOhaCW2MYY.png", link: "https://www.patreon.com/", category: "social", energy: "high", tags: [], browser: false },
      { id: "kofi", name: "Ko-fi", rate: "$1‚Äì$1,000+/tip", desc: "Digital tip jar. 0% fees on tips! Sell products too.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/rV3EmPqdyk7oLMwji0FC.png", link: "https://ko-fi.com/", category: "social", energy: "med", tags: ["beginner", "quick"], browser: false },
      { id: "facebook", name: "Facebook", rate: "$100‚Äì$10,000+/post", desc: "Marketplace, groups, sponsored content. Huge reach.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/joOXU3pGdlKULwwTQ7K7.png", link: "https://www.facebook.com/", category: "social", energy: "med", tags: [], browser: false },
      { id: "x", name: "X (Twitter)", rate: "$50‚Äì$5,000+/tweet", desc: "Microblogging. Sponsored tweets, ad revenue sharing.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/bvwxaR2mEAAX605zQhsx.png", link: "https://www.x.com/", category: "social", energy: "med", tags: [], browser: false },
      { id: "linkedin", name: "LinkedIn", rate: "$500‚Äì$20,000+/gig", desc: "Professional networking. Speaking gigs, courses, clients.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/DiQhmMBQMIupg107v1KD.png", link: "https://www.linkedin.com/", category: "social", energy: "high", tags: ["highpay"], browser: false },
      
      // Handmade Goods
      { id: "etsy", name: "ü•∞ Etsy", rate: "Self-set", desc: "Global marketplace for handmade, vintage, and creative goods.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/pvvTqqHXOWCv5aaHVeWe.jpg", link: "https://etsy.com/", category: "handmade", energy: "high", tags: [], fave: true, browser: false },
      { id: "amazonhandmade", name: "Amazon Handmade", rate: "Self-set", desc: "Sell artisan products on Amazon's massive customer base.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/vXq9tx9PrQnlM3UYpxcQ.png", link: "https://amzn.to/4iuPkoW", category: "handmade", energy: "high", tags: [], browser: false },
      { id: "printify", name: "Printify", rate: "Self-set", desc: "Print-on-demand. Design products, no inventory needed!", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/EqIVRaEWxVI0Zx1EETTB.png", link: "https://printify.com/", category: "handmade", energy: "high", tags: ["beginner"], browser: false },
      { id: "shopify", name: "Shopify", rate: "Self-set", desc: "Build your own online store. Full control, no marketplace fees.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/btCVM7WHtPjyDkOzTYM9.png", link: "https://www.shopify.com/", category: "handmade", energy: "high", tags: [], browser: false },
      { id: "bigcartel", name: "Big Cartel", rate: "Self-set", desc: "Simple store for artists. Free plan with 5 products!", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/ewYZW2h7UsgFBwovET4X.png", link: "https://www.bigcartel.com/", category: "handmade", energy: "high", tags: ["beginner", "quick"], browser: false },
      { id: "folksy", name: "Folksy", rate: "Self-set", desc: "UK handmade marketplace. Charming village market vibes.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/kkiMUUFxv2vhogMosyDK.png", link: "https://folksy.com/", category: "handmade", energy: "high", tags: [], browser: false },
      
      // Care & Service
      { id: "carecom", name: "Care.com", rate: "$20‚Äì$35/hr", desc: "Babysitting, elder care, special needs. Flexible compassionate work.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/5I3e2N4NAjdUE4PJqfKY.dat", link: "https://www.care.com", category: "care", energy: "high", tags: ["highpay"], browser: false },
      { id: "rover", name: "Rover", rate: "$20‚Äì$40/hr", desc: "Dog walking, pet sitting, boarding. \"Airbnb for pets\"!", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/n8yzcHBxOVGYzZeYTAPc.png", link: "https://rover.com", category: "care", energy: "med", tags: ["highpay", "beginner"], browser: false },
      { id: "wag", name: "Wag", rate: "$13‚Äì$25/hr", desc: "Quick dog walks, drop-ins. On-demand gigs, fast bookings.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/Cw1AUklnSjvwc5cFkDgL.png", link: "https://wagwalking.com", category: "care", energy: "med", tags: ["quick", "beginner"], browser: false },
      { id: "taskrabbit", name: "TaskRabbit", rate: "$17.50‚Äì$50+/hr", desc: "Cleaning, handyman, moving, IKEA assembly, errands.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/Y0lwF8oCSOa0ygsFLxiQ.jpg", link: "https://taskrabbit.com", category: "care", energy: "high", tags: ["highpay"], browser: false },
      { id: "papa", name: "Papa", rate: "$13‚Äì$20/hr", desc: "Senior companionship, errands, friendly conversation.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/OdxfBWuzWg2E3ANzr6ua.jpg", link: "https://papa.com", category: "care", energy: "med", tags: ["beginner"], browser: false },
      { id: "trustedhousesitters", name: "Trusted Housesitters", rate: "Free lodging", desc: "Pet & house sit worldwide. Travel exchange, membership required.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/jIeyGBhuLLHKbK542yIO.png", link: "https://trustedhousesitters.com", category: "care", energy: "med", tags: [], browser: false },
      { id: "neighbor", name: "Neighbor", rate: "$50‚Äì$600/month", desc: "Rent out storage space, garages, driveways. Passive income!", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/N6RhLYI5sYTjDX1HUQYO.png", link: "https://neighbor.com", category: "care", energy: "low", tags: ["quick", "beginner"], browser: false },
      { id: "chewy", name: "Chewy (Remote Jobs)", rate: "$16‚Äì$19.50/hr", desc: "Remote customer service. ADHD-friendly, pet-positive culture.", logo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/QNRVyClen6pxcHI6ygv0.png", link: "https://careers.chewy.com/us/en/c/customer-service-jobs", category: "care", energy: "med", tags: [], browser: false },
    ];
    
    // Category labels
    const categories = {
      fun: { icon: "üéÆ", name: "Fun or Interesting" },
      surveys: { icon: "üìä", name: "Surveys & Market Research" },
      ai: { icon: "ü§ñ", name: "AI Training & Data Work" },
      testing: { icon: "üïπÔ∏è", name: "Playtesting & App Testing" },
      microtasks: { icon: "‚öôÔ∏è", name: "Microtasks & Crowdsourcing" },
      expert: { icon: "üßë‚Äç‚öïÔ∏è", name: "Expert Consultations" },
      mystery: { icon: "üïµÔ∏è", name: "Mystery Shoppers" },
      transcription: { icon: "üéß", name: "Transcription" },
      voice: { icon: "üéôÔ∏è", name: "Voice & Audio Work" },
      writing: { icon: "‚úçÔ∏è", name: "Content Writing" },
      teaching: { icon: "üë©‚Äçüè´", name: "Online Teaching" },
      va: { icon: "üíº", name: "Virtual Assistant" },
      freelance: { icon: "üåê", name: "Freelancing Marketplaces" },
      social: { icon: "üì±", name: "Social Media" },
      handmade: { icon: "üé®", name: "Handmade Goods" },
      care: { icon: "üêæ", name: "Care & Service" }
    };
    // Category order used for tabs & rendering
    const catOrder = ['fun','surveys','ai','testing','microtasks','mystery','transcription','voice','writing','teaching','va','freelance','expert','social','handmade','care'];

    // Category state (single-select) and tags (multi-select)
    let activeCategory = null; // null === All
    const activeTags = new Set(); // e.g. 'quick','highpay','beginner'
    
    // State
    let activeEnergy = null;
    let activeFilter = 'all';
    let searchQuery = '';
    let favorites = JSON.parse(localStorage.getItem('925adhd_favorites') || '[]');
    
    // DOM elements
    const gigGrid = document.getElementById('gigGrid');
    const resultsText = document.getElementById('resultsText');
    const totalCount = document.getElementById('totalCount');
    const clearBtn = document.getElementById('clearBtn');
    const emptyState = document.getElementById('emptyState');
    const searchInput = document.getElementById('searchInput');
    const energyCards = document.querySelectorAll('.energy-card');
    const batteryLevelEl = document.getElementById('batteryLevel');
    const filterChips = document.querySelectorAll('.filter-chip');
    const filterSelect = document.getElementById('filterSelect');

    // Top filter chips (quick/highpay/beginner) should behave like the apps page tabs:
    // - 'All' clears tag filters
    // - clicking a tag makes it the active tag (single-select); clicking again clears it
    if (filterChips && filterChips.length) {
      filterChips.forEach(ch => {
        ch.addEventListener('click', (e) => {
          e.preventDefault();
          const key = ch.dataset.filter;
          if (!key) return;

          if (key === 'all') {
            // clear any active tag shortcuts
            activeTags.clear();
            // reset activeFilter to 'all' for legacy compatibility
            activeFilter = 'all';
          } else {
            // single-select behavior: if clicked again, clear selection
            if (activeTags.size === 1 && activeTags.has(key)) {
              activeTags.clear();
            } else {
              activeTags.clear();
              activeTags.add(key);
            }
            // mark that we're using a tag-based quick filter
            activeFilter = key;
          }

          // update chip visual states
          filterChips.forEach(fc => fc.classList.toggle('active', fc === ch ? activeTags.has(fc.dataset.filter) || (fc.dataset.filter === 'all' && activeTags.size===0) : false));

          // update tag popover chips if present
          const menu = document.getElementById('filterMenu');
          if (menu) {
            menu.querySelectorAll('.tag-chip').forEach(tc => {
              const v = tc.dataset.value;
              tc.classList.toggle('active', v && activeTags.has(v));
            });
          }
          const topClear = document.getElementById('clearBtn');
          if (topClear) {
            const has = activeTags.size > 0 || activeFilter !== 'all' || activeEnergy || searchQuery || activeCategory;
            topClear.classList.toggle('hidden', !has);
            topClear.hidden = !has;
          }

          // re-render results
          if (typeof renderGigs === 'function') renderGigs();
        });
      });
    }

    // Sync clear button hidden attribute for accessibility
    function syncClearButton() {
      if (!clearBtn) return;
      // hidden when no active filters/search/energy/categories/tags
      const active = !!(activeEnergy || activeFilter !== 'all' || searchQuery || activeCategory || activeTags.size > 0);
      clearBtn.hidden = !active;
    }
    
    // Render all gigs
    function renderGigs() {
      const filtered = filterGigs();
      
      if (filtered.length === 0) {
        gigGrid.innerHTML = '';
        emptyState.classList.remove('hidden');
        resultsText.textContent = 'No matches';
        if (totalCount) totalCount.textContent = '0';
        return;
      }
      
      emptyState.classList.add('hidden');
      
      // Group by category
      const grouped = {};
      filtered.forEach(gig => {
        if (!grouped[gig.category]) grouped[gig.category] = [];
        grouped[gig.category].push(gig);
      });
      
      // Render
      let html = '';
      const catOrder = ['fun', 'surveys', 'ai', 'testing', 'microtasks', 'mystery', 'transcription', 'voice', 'writing', 'teaching', 'va', 'freelance', 'expert', 'social', 'handmade', 'care'];
      
      catOrder.forEach(catKey => {
        if (!grouped[catKey]) return;
        const cat = categories[catKey];
        const catGigs = grouped[catKey];
        
        html += `<h3 class="category-header">${cat.icon} ${cat.name} <span class="category-count">(${catGigs.length})</span></h3>`;
        
        catGigs.forEach(gig => {
          const isFav = favorites.includes(gig.id);
          const tags = [];
          
          if (gig.energy === 'low') tags.push('<span class="tag energy-low">üò¥ Low energy</span>');
          if (gig.energy === 'med') tags.push('<span class="tag energy-med">üòä Medium</span>');
          if (gig.energy === 'high') tags.push('<span class="tag energy-high">‚ö° High energy</span>');
          if (gig.browser) tags.push('<span class="tag browser">üíª Browser</span>');
          if (gig.tags.includes('quick')) tags.push('<span class="tag quick">‚ö° Fast</span>');
          if (gig.tags.includes('gift')) tags.push('<span class="tag gift">Gift cards</span>');
          if (gig.fave) tags.push('<span class="tag fave">ü•∞ Favorite</span>');
          
          // include a data-tags attribute so small client-side filters can also work
          const tagAttr = (gig.tags && gig.tags.length) ? ` data-tags="${gig.tags.join(' ')}"` : '';
          html += `
            <a href="gig-detail.html?gig=${gig.id}&fromGig=${gig.id}" class="gig-card ${isFav ? 'favorite' : ''}" data-id="${gig.id}"${tagAttr}>
              <img src="images/${gig.id}.png" class="gig-logo" alt="${gig.name}" loading="lazy" onerror="attemptImageFallback(this,'${gig.id}','${gig.logo}')">
              <div class="gig-content">
                <div class="gig-header">
                  <div class="gig-name">${gig.name}</div>
                  <button class="fav-btn ${isFav ? 'active' : ''}" data-gig="${gig.id}" onclick="event.preventDefault(); event.stopPropagation(); toggleFav('${gig.id}', this);">${isFav ? '‚ù§Ô∏è' : 'ü§ç'}</button>
                </div>
                <div class="gig-rate">${gig.rate}</div>
                <div class="gig-desc">${gig.desc}</div>
                <div class="gig-tags">${tags.join('')}</div>
              </div>
            </a>
          `;
        });
      });
      
      gigGrid.innerHTML = html;
      resultsText.textContent = `Showing ${filtered.length} option${filtered.length !== 1 ? 's' : ''}`;
      const resultsCountEl = document.getElementById('resultsCount');
      if (resultsCountEl) resultsCountEl.textContent = filtered.length;
      if (totalCount) totalCount.textContent = filtered.length;

      // Show/hide clear button (keep class-based logic for compatibility)
      if (activeEnergy || activeFilter !== 'all' || searchQuery || activeCategory || activeTags.size > 0) {
        clearBtn.classList.remove('hidden');
      } else {
        clearBtn.classList.add('hidden');
      }
      // sync hidden attribute for accessibility
      if (typeof syncClearButton === 'function') syncClearButton();
    }

    // Render category tabs (apps-like)
    function renderCategoryTabs() {
      const container = document.getElementById('categoryTabs');
      if (!container) return;
      container.innerHTML = '';

      const makeButton = (label, key, isActive) => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'tab-btn' + (isActive ? ' active' : '');
        btn.dataset.cat = key;
        btn.innerHTML = label;

        // 'all' clears category selection
        if (key === 'all') {
          btn.addEventListener('click', () => {
            activeCategory = null;
            if (typeof renderCategoryTabs === 'function') renderCategoryTabs();
            renderGigs();
          });
          return btn;
        }

        btn.addEventListener('click', () => {
          const currentlyActive = activeCategory === key;
          if (currentlyActive) {
            activeCategory = null;
          } else {
            activeCategory = key;
          }
          // re-render tabs to update 'All' state
          if (typeof renderCategoryTabs === 'function') renderCategoryTabs();
          renderGigs();
        });
        return btn;
      };

      // Add explicit 'All' button first
      container.appendChild(makeButton('All', 'all', activeCategory === null));

      // Build the rest of the tabs (single-select)
      catOrder.forEach(key => {
        const cat = categories[key];
        if (!cat) return;
        const label = `${cat.icon} ${cat.name}`;
        container.appendChild(makeButton(label, key, activeCategory === key));
      });
      // ensure container keeps its reserved space; no reveal needed
    }

    // Setup desktop arrow scroller for category tabs
    function setupCategoryScroller() {
      const container = document.getElementById('categoryTabs');
      const left = document.getElementById('catScrollLeft');
      const right = document.getElementById('catScrollRight');
      if (!container || !left || !right) return;

      const scrollAmount = () => Math.max(container.clientWidth * 0.6, 160);

      left.addEventListener('click', () => {
        container.scrollBy({ left: -scrollAmount(), behavior: 'smooth' });
      });
      right.addEventListener('click', () => {
        container.scrollBy({ left: scrollAmount(), behavior: 'smooth' });
      });

      function updateButtons() {
        // Only show scroller arrows when the tabs actually overflow the visible container.
        const overflow = container.scrollWidth > container.clientWidth + 4; // small tolerance
        if (!overflow) {
          left.style.display = 'none';
          right.style.display = 'none';
          return;
        }
        // hide left at start, hide right at end
        left.style.display = container.scrollLeft > 8 ? 'flex' : 'none';
        right.style.display = (container.scrollLeft + container.clientWidth) < (container.scrollWidth - 8) ? 'flex' : 'none';
      }

      container.addEventListener('scroll', updateButtons);
      window.addEventListener('resize', updateButtons);

      // re-evaluate after tabs are rendered
      setTimeout(updateButtons, 60);
      // ensure visible state immediately
      updateButtons();
    }
    
    // Tag panel behavior (improved): toggles chips, persists selection in `activeTags`, and delegates filtering to renderGigs()
    function setupTagPanel() {
      const filter = document.getElementById('filter');
      const btn = document.getElementById('filterBtn');
      const menu = document.getElementById('filterMenu');
      const clearBtnEl = document.getElementById('clearBtn');
      const resultsTextEl = document.getElementById('resultsText');

      if (!filter || !btn || !menu || !clearBtnEl || !resultsTextEl) return;

      function openMenu() { menu.classList.remove('hidden'); btn.setAttribute('aria-expanded','true'); }
      function closeMenu() { menu.classList.add('hidden'); btn.setAttribute('aria-expanded','false'); }

      function updateClearBtn() {
        const has = activeTags.size > 0;
        clearBtnEl.classList.toggle('hidden', !has);
        clearBtnEl.hidden = !has;
      }

      function syncChipStates() {
        menu.querySelectorAll('.tag-chip').forEach(chip => {
          const v = chip.dataset.value;
          chip.classList.toggle('active', activeTags.has(v));
        });
        const label = btn.querySelector('.filter-text');
        if (label) label.textContent = activeTags.size ? `Tags (${activeTags.size})` : 'Tags';
      }

      // Open/close toggle
      btn.addEventListener('click', (e) => { e.stopPropagation(); const isOpen = !menu.classList.contains('hidden'); isOpen ? closeMenu() : openMenu(); });

      // Chip toggle via delegated click inside menu
      menu.addEventListener('click', (e) => {
        const chip = e.target.closest('.tag-chip');
        if (!chip) return;
        e.stopPropagation();
        const value = chip.dataset.value;
        if (!value) return;
        // Special-case favorites: toggle the favorites filter (uses activeFilter)
        if (value === 'favorites' || value === 'fave') {
          if (activeFilter === 'favorites') {
            activeFilter = 'all';
            // also clear activeTags to avoid mixed states
            activeTags.clear();
          } else {
            activeFilter = 'favorites';
          }
          // reflect new state on top filter chips
          filterChips.forEach(fc => fc.classList.toggle('active', fc.dataset.filter === activeFilter));
          syncChipStates();
          updateClearBtn();
          if (typeof renderGigs === 'function') renderGigs();
          return;
        }

        // Default tag behavior: toggle in activeTags set
        if (activeTags.has(value)) activeTags.delete(value); else activeTags.add(value);
        syncChipStates();
        updateClearBtn();
        // delegate filtering to existing renderGigs/filterGigs logic which reads `activeTags`
        if (typeof renderGigs === 'function') renderGigs();
      });

      // Clear handler
      clearBtnEl.addEventListener('click', (e) => {
        e.stopPropagation();
        activeTags.clear();
        syncChipStates();
        updateClearBtn();
        if (typeof renderGigs === 'function') renderGigs();
        closeMenu();
      });

      // Close when clicking outside the filter area
      document.addEventListener('click', (e) => { if (!filter.contains(e.target)) closeMenu(); });

      // Keyboard: Escape closes, Enter/Space toggles when focused on chip
      menu.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') { closeMenu(); }
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          const focused = document.activeElement;
          if (focused && focused.classList.contains('tag-chip')) focused.click();
        }
      });

      // Initialize chip states and clear button
      syncChipStates();
      updateClearBtn();
    }
    
    // Active tags are shown inside the Tags popover; we no longer duplicate them at the top.
    
    // Filter gigs
    function filterGigs() {
      return gigs.filter(gig => {
        // category filter (tabs) ‚Äî single-select
        if (activeCategory && gig.category !== activeCategory) return false;
        // tag filters (AND): every selected tag must be present
        if (activeTags.size > 0) {
          for (const t of activeTags) {
            if (!gig.tags || !gig.tags.includes(t)) return false;
          }
        }
        // Energy filter
        if (activeEnergy && gig.energy !== activeEnergy) return false;

        // Other dropdown-based legacy filters (favorites/browser) kept for compatibility
        if (activeFilter === 'favorites' && !favorites.includes(gig.id)) return false;
        if (activeFilter === 'browser' && !gig.browser) return false;

        // Search
        if (searchQuery) {
          const text = (gig.name + ' ' + gig.desc + ' ' + gig.category).toLowerCase();
          if (!text.includes(searchQuery)) return false;
        }

        return true;
      });
    }
    
    // Toggle favorite
    function toggleFav(gigId, btn) {
      if (favorites.includes(gigId)) {
        favorites = favorites.filter(f => f !== gigId);
        btn.textContent = 'ü§ç';
        btn.classList.remove('active');
        btn.closest('.gig-card').classList.remove('favorite');
      } else {
        favorites.push(gigId);
        btn.textContent = '‚ù§Ô∏è';
        btn.classList.add('active');
        btn.closest('.gig-card').classList.add('favorite');
      }
      localStorage.setItem('925adhd_favorites', JSON.stringify(favorites));
      
      // Re-render if on favorites view
      if (activeFilter === 'favorites') {
        renderGigs();
      }
    }
    
    // Clear all filters
    function clearAllFilters() {
      activeEnergy = null;
      activeFilter = 'all';
      activeCategory = null;
      activeTags.clear();
      searchQuery = '';
      searchInput.value = '';
      
      // reset energy selector
      energyCards.forEach(b => b.setAttribute('aria-pressed','false'));
      if (batteryLevelEl) batteryLevelEl.value = '';
      filterChips.forEach(c => c.classList.remove('active'));
      document.querySelector('[data-filter="all"]').classList.add('active');
      // reset dropdown filter if present
      const filterSelectEl = document.getElementById('filterSelect');
      if (filterSelectEl) filterSelectEl.value = 'all';
      // re-render tabs to clear state and then refresh gigs
      if (typeof renderCategoryTabs === 'function') renderCategoryTabs();
      renderGigs();
    }
    
    // Event listeners
    energyCards.forEach(btn => {
      btn.addEventListener('click', () => {
        const level = btn.dataset.level; // low | ok | hyper

        // toggle pressed state
        const pressed = btn.getAttribute('aria-pressed') === 'true';
        energyCards.forEach(b => b.setAttribute('aria-pressed','false'));
        if (!pressed) {
          btn.setAttribute('aria-pressed','true');
          activeEnergy = (level === 'ok') ? 'med' : (level === 'hyper' ? 'high' : 'low');
          if (batteryLevelEl) batteryLevelEl.value = level;
        } else {
          // deselected
          activeEnergy = null;
          if (batteryLevelEl) batteryLevelEl.value = '';
        }

        renderGigs();
      });
    });
    
    filterChips.forEach(chip => {
      chip.addEventListener('click', () => {
        filterChips.forEach(c => c.classList.remove('active'));
        chip.classList.add('active');
        activeFilter = chip.dataset.filter;
        renderGigs();
      });
    });

    
    
    searchInput.addEventListener('input', (e) => {
      searchQuery = e.target.value.toLowerCase().trim();
      renderGigs();
    });
    
    clearBtn.addEventListener('click', clearAllFilters);
    
    // Pro tips rotation
    const proTips = [
      { strong: "üß† ADHD tip:", text: "Pick ONE option that fits your energy. Sign up while you‚Äôre motivated. Future you says thanks." },
      { strong: "üí° Decision Fatigue Fix:", text: "Use the energy filter above. Low? Stick to surveys. Hyperfocus mode? Try Etsy or freelancing!" },
      { strong: "‚ù§Ô∏è Dopamine Hack:", text: "Save your favorites (tap the heart) so you can come back without decision paralysis." },
      { strong: "üìà Stacking Strategy:", text: "Sign up for 2-3 survey sites now. More options = more available tasks when you need them." },
      { strong: "‚ö° Quick Win:", text: "Prolific + Survey Junkie + PaidViewpoint = solid survey stack you can set up in 15 minutes." }
    ];
    
    let tipIndex = 0;
    const proTipEl = document.getElementById('proTip');
    
    setInterval(() => {
      tipIndex = (tipIndex + 1) % proTips.length;
      const tip = proTips[tipIndex];
      proTipEl.innerHTML = `<strong>${tip.strong}</strong> ${tip.text}`;
    }, 12000);
    
    // Image files available locally (used to match IDs to existing filenames)
    const imageFiles = [
      "99designs.png","acx.jpg","amazonhandmade.png","appen.jpg","behance.png","belay.png","benjamin.jpg","benjamn.jpg","best play.jpg","bestmark.jpg","bigcartel.png","blob-bacb09e.webp","brain.jpeg","bytlixir.png","caht gpt.png","cambly.png","castingwords.png","channels4_profile.jpg","Chewy-logo-web.png","claude.jpg","claude.png","clearvoice.png","clickworker.png","contently.jpg","crowdtap.jpg","designcrowd.png","discord logo.png","doordash.png","download.jpeg","download.png","dribble.png","dscout.png","etsy.jpg","facebook.png","fancy hand.jpg","fetch.png","fieldagent.png","fiverr.png","flex.png","folksy.png","freelanmcer.png","gigspot.jpg","gigspot.png","gotranscript.png","honeygain.png","ibotta.png","influenster.png","instacart.png","instagram.jpg","isecretshop.jpg","italki.png","ivueit.png","just play.jpg","kofi.png","lifepoints.png","linkedin.png","marketforce.png","methinks.png","minsk-belarus-03272023-openai-chatgpt-600nw-2281899103.webp","mistplay.jpg","mode earn app.jpg","neevo.png","neighbor.png","outlier.png","paidviewpoint.png","papa.jpg","patreon.png","pawns.png","pinecone.png","pogo.jpg","posting_checklist.png","preply.png","pressplay.png","presto.jpg","printify.png","prolific.png","proxypics.png","quicktate.png","rakuten.jpg","respondent.png","rev.png","rover.png","rs=w_600,cg_true.webp","rs=w_600,h_300,cg_true (1).webp","rs=w_600,h_300,cg_true.webp","rs=w_600,h_800,cg_true.webp","rs=w_984,h_984.webp","scribie.jpg","scribie.png","scripted.png","shopify.png","slicethepie.jpg","snapchat.png","spark.png","speechpad.jpg","streetbees.png","surveyjunkie.jpg","swagbucks.png","sweatcoin.jpg","syllaby.png","tastrabbit.jpg","tigerfish.jpg","tiktok.png","timeect.png","toluna.png","toptal.png","transcribeme.jpg","trust.png","trustedhousesitters.png","twitch.png","ubereats.png","upwork.png","usertesting.png","voice123.png","voices.png","wag.png","writeraccess.png","wyzant.jpg","x.png","youtube.png"
    ];
    const imageMap = {
      'respondentio': 'respondent.png',
      'pineconeresearch': 'pinecone.png',
      'prestoshopper': 'presto.jpg',
      'timeetc': 'timeect.png',
      'fancyhands': 'fancy hand.jpg',
      'belaysolutions': 'belay.png',
      'freelancer': 'freelanmcer.png',
      'carecom': 'care.jpg',
      'chewy': 'chewy.png'
    };

    function attemptImageFallback(img, id, remote) {
      try {
        const norm = s => s.replace(/[^a-z0-9]/g,'').toLowerCase();
        const idNorm = norm(id);

        // If there's an explicit mapping for this id, use it first
        if (imageMap && imageMap[id]) {
          img.onerror = null;
          img.src = 'images/' + imageMap[id];
          return;
        }

        // If there are local files that include the id text, prefer them
        for (const f of imageFiles) {
          if (norm(f).includes(idNorm) || idNorm.includes(norm(f))) {
            img.onerror = null;
            img.src = 'images/' + f;
            return;
          }
        }

        // Otherwise, try common extensions for the canonical id filename
        if (!img.dataset.attempt) { img.dataset.attempt = 'png'; img.src = `images/${id}.png`; return; }
        if (img.dataset.attempt === 'png') { img.dataset.attempt = 'jpg'; img.src = `images/${id}.jpg`; return; }
        if (img.dataset.attempt === 'jpg') { img.dataset.attempt = 'webp'; img.src = `images/${id}.webp`; return; }

        // Last resort: use inline SVG placeholder (no external fallbacks)
        img.onerror = null;
        img.src = 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect fill=%22%232a2a2a%22 width=%22100%22 height=%22100%22/><text x=%2250%22 y=%2255%22 text-anchor=%22middle%22 fill=%22%23888%22 font-size=%2240%22>üíº</text></svg>';
      } catch (e) {
        img.onerror = null;
        img.src = 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect fill=%22%232a2a2a%22 width=%22100%22 height=%22100%22/><text x=%2250%22 y=%2255%22 text-anchor=%22middle%22 fill=%22%23888%22 font-size=%2240%22>üíº</text></svg>';
      }
    }

    // Initialize
    // Find the nearest scrollable ancestor of an element (or return `window`)
    function getScrollContainer(el) {
      if (!el) return window;
      let node = el;
      while (node && node !== document.documentElement) {
        const style = window.getComputedStyle(node);
        const overflowY = style ? style.overflowY : '';
        if ((overflowY === 'auto' || overflowY === 'scroll') && node.scrollHeight > node.clientHeight) {
          return node;
        }
        node = node.parentElement;
      }
      return window;
    }

    // Save scroll position before navigating away. Also save which container we used.
    function saveScrollPosition() {
      try {
        const grid = document.getElementById('gigGrid');
        const container = getScrollContainer(grid);
        if (container === window) {
          sessionStorage.setItem('925adhd_earn_scroll', String(window.scrollY || window.pageYOffset || 0));
          sessionStorage.setItem('925adhd_scroll_container', 'window');
        } else {
          // Prefer storing an id selector when available
          const id = container.id ? `#${container.id}` : null;
          if (id) sessionStorage.setItem('925adhd_scroll_container', id);
          else sessionStorage.setItem('925adhd_scroll_container', 'element');
          sessionStorage.setItem('925adhd_earn_scroll', String(container.scrollTop || 0));
        }
      } catch (e) { /* ignore */ }
    }

    // Restore scroll position on page load (for back navigation)
    function restoreScrollPosition() {
      // Prefer restoring by last-viewed gig (more reliable across navigation types)
      const lastGig = sessionStorage.getItem('925adhd_last_gig');
      const savedScroll = sessionStorage.getItem('925adhd_earn_scroll');
      const savedContainer = sessionStorage.getItem('925adhd_scroll_container') || 'window';
      if (lastGig) {
        // If the element is already present, scroll immediately
        const attemptScroll = () => {
          const elNow = document.querySelector(`.gig-card[data-id="${lastGig}"]`);
          if (elNow) {
            // If a custom container was used, ensure we scroll within that container.
            try {
              const container = (savedContainer && savedContainer !== 'window') ? document.querySelector(savedContainer) : getScrollContainer(elNow);
              if (container && container !== window) {
                // scroll the card into view within the container
                elNow.scrollIntoView({ block: 'center', inline: 'nearest', behavior: 'auto' });
              } else {
                elNow.scrollIntoView({ block: 'center', behavior: 'auto' });
              }
            } catch (e) {
              elNow.scrollIntoView({ block: 'center', behavior: 'auto' });
            }
            try { sessionStorage.removeItem('925adhd_last_gig'); } catch (e) {}
            try { sessionStorage.removeItem('925adhd_earn_scroll'); } catch (e) {}
            return true;
          }
          return false;
        };

        if (attemptScroll()) return;

        // Otherwise observe the gig grid until it stabilizes, then scroll
        const grid = document.querySelector('.gig-grid');
        if (!grid) {
          // fallback to absolute scroll after a short delay
          if (savedScroll !== null) {
            requestAnimationFrame(() => {
              if (savedContainer && savedContainer !== 'window') {
                const cont = document.querySelector(savedContainer);
                if (cont) cont.scrollTop = parseInt(savedScroll, 10);
                else window.scrollTo(0, parseInt(savedScroll, 10));
              } else {
                window.scrollTo(0, parseInt(savedScroll, 10));
              }
              try { sessionStorage.removeItem('925adhd_earn_scroll'); } catch(e){}
            });
          }
          return;
        }

        let stabilityTimer = null;
        const obs = new MutationObserver(() => {
          if (stabilityTimer) clearTimeout(stabilityTimer);
          stabilityTimer = setTimeout(() => {
            if (attemptScroll()) {
              obs.disconnect();
            }
          }, 250);
        });
        obs.observe(grid, { childList: true, subtree: true });

        // Safety timeout: if nothing found after ~6s, fallback to absolute scroll
        setTimeout(() => {
          try { obs.disconnect(); } catch (e) {}
          const elFinally = document.querySelector(`.gig-card[data-id="${lastGig}"]`);
          if (elFinally) {
            try {
              if (savedContainer && savedContainer !== 'window') {
                const cont = document.querySelector(savedContainer);
                if (cont) elFinally.scrollIntoView({ block: 'center', inline: 'nearest', behavior: 'auto' });
                else elFinally.scrollIntoView({ block: 'center', behavior: 'auto' });
              } else {
                elFinally.scrollIntoView({ block: 'center', behavior: 'auto' });
              }
            } catch (e) { elFinally.scrollIntoView({ block: 'center', behavior: 'auto' }); }
            try { sessionStorage.removeItem('925adhd_last_gig'); } catch (e) {}
            try { sessionStorage.removeItem('925adhd_earn_scroll'); } catch (e) {}
            return;
          }
          if (savedScroll !== null) {
            requestAnimationFrame(() => {
              if (savedContainer && savedContainer !== 'window') {
                const cont = document.querySelector(savedContainer);
                if (cont) cont.scrollTop = parseInt(savedScroll, 10);
                else window.scrollTo(0, parseInt(savedScroll, 10));
              } else {
                window.scrollTo(0, parseInt(savedScroll, 10));
              }
              try { sessionStorage.removeItem('925adhd_earn_scroll'); } catch(e){}
            });
          }
        }, 6000);
        return;
      }

      if (savedScroll !== null) {
        requestAnimationFrame(() => {
          if (savedContainer && savedContainer !== 'window') {
            const cont = document.querySelector(savedContainer);
            if (cont) cont.scrollTop = parseInt(savedScroll, 10);
            else window.scrollTo(0, parseInt(savedScroll, 10));
          } else {
            window.scrollTo(0, parseInt(savedScroll, 10));
          }
          try { sessionStorage.removeItem('925adhd_earn_scroll'); } catch (e) {}
        });
      }
    }

    // Attach click handlers to gig cards to save scroll before navigating
    function attachScrollSaveToCards() {
      // Per-card listeners (attach to current nodes)
      document.querySelectorAll('.gig-card').forEach(card => {
        card.removeEventListener('click', card._saveHandler);
        card._saveHandler = function saveAndMark(ev) {
          try {
            saveScrollPosition();
            const id = card.getAttribute('data-id') || card.dataset.id;
            if (id) sessionStorage.setItem('925adhd_last_gig', id);
          } catch (e) {}
        };
        card.addEventListener('click', card._saveHandler);
      });

      // Delegated handler on the grid as a robust fallback (works if nodes are swapped)
      const grid = document.getElementById('gigGrid');
      if (grid && !grid._delegatedSaveHandler) {
        grid._delegatedSaveHandler = function (ev) {
          try {
            const card = ev.target.closest && ev.target.closest('.gig-card');
            if (!card) return;
            const id = card.getAttribute('data-id') || card.dataset.id;
            if (id) {
              sessionStorage.setItem('925adhd_last_gig', id);
              saveScrollPosition();
            }
          } catch (e) {}
        };
        grid.addEventListener('click', grid._delegatedSaveHandler, true);
      }
    }

    // Override renderGigs to also attach scroll save handlers
    const originalRenderGigs = renderGigs;
    renderGigs = function() {
      originalRenderGigs();
      attachScrollSaveToCards();
    };

    // Initialize
    // Prevent browser auto-restoration interfering with our manual logic
    try { if ('scrollRestoration' in history) history.scrollRestoration = 'manual'; } catch (e) {}
    renderGigs();

    // Restore scroll position after render (handles back navigation)
    restoreScrollPosition();

    // Save scroll when page is being hidden (covers some navigation types)
    window.addEventListener('pagehide', function () { saveScrollPosition(); });

    // When navigating back via bfcache, `pageshow` fires with `persisted===true`.
    // Call restoreScrollPosition on pageshow to handle cache restores.
    window.addEventListener('pageshow', function (e) {
      // Always attempt to restore (covers both normal load and bfcache)
      restoreScrollPosition();
    });

    // Initialize the page - render category tabs and setup UI
    renderCategoryTabs();
    setupCategoryScroller();
    setupTagPanel();
  </script>
  <script src="assets/layout.js"></script>
  <script>
    // Hide loading screen after layout.js has finished
    window.addEventListener('load', () => {
      const loadingScreen = document.getElementById('loadingScreen');
      if (loadingScreen) {
        loadingScreen.style.display = 'none';
      }
      document.body.classList.add('loaded');
    });
  </script>
</body>
</html>
