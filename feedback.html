<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Feedback ‚Äî Submit bugs or feature ideas</title>
  <link rel="stylesheet" href="assets/layout.css">
  <style>
    /* Page-specific tweaks that sit on top of the main layout */
    body.has-site-layout{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;-webkit-font-smoothing:antialiased}
    .wrap{max-width:820px;margin:20px auto;padding:18px;border-radius:12px;background:var(--card);border:1px solid rgba(255,255,255,.04);color:var(--text);box-shadow:0 6px 28px rgba(0,0,0,.5)}
    h1{margin:0 0 6px;font-size:18px;color:var(--text)}
    p.lead{margin:0 0 18px;color:var(--text-muted)}
    label{display:block;margin-top:12px;font-weight:700;color:var(--text)}
    input[type=text],input[type=email],textarea,select{width:100%;padding:10px;border:1px solid rgba(255,255,255,.04);border-radius:8px;margin-top:6px;background:transparent;color:var(--text);box-sizing:border-box}
    textarea{min-height:120px;resize:vertical}
    .muted{color:var(--text-muted);font-size:13px}
    .actions{margin-top:16px}
    button{background:var(--brand);border:none;color:var(--bg);padding:12px 20px;border-radius:8px;cursor:pointer;font-weight:600;width:100%}
    button:hover{opacity:0.9}
    .notice{margin-top:12px;padding:12px;border-radius:8px;background:rgba(86,195,174,.12);color:var(--text)}
    .hidden{display:none}
    .small{font-size:13px;color:var(--text-muted)}
    input[type=file]{margin-top:8px;color:var(--text)}
    main.main-content{padding:18px 16px 36px;max-width:900px;margin:0 auto}
    .email-section{margin-top:12px;padding:12px;border-radius:8px;background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.06)}
    .email-section.hidden{display:none}
    .checkbox-row{display:flex;align-items:center;gap:8px;margin-top:14px}
    .checkbox-row label{margin:0;font-weight:400;cursor:pointer}
    .checkbox-row input[type=checkbox]{width:auto;margin:0}
    /* Improve contrast for native select dropdowns (options can inherit light text on
       dark backgrounds in some browsers; force readable option text/background here) */
    .select-wrap{display:inline-block;position:relative}
    .select-wrap select {
      background: var(--card);
      color: var(--text);
      border: 1px solid rgba(255,255,255,0.06);
      -webkit-appearance: none;
      appearance: none;
      background-image: none; /* hide native arrow */
      background-repeat: no-repeat;
      padding-right: 34px; /* room for custom chevron */
      width: auto;           /* don't force full width */
      min-width: 220px;
      max-width: 420px;
      display: inline-block;
    }
    .select-wrap::after{
      content:'‚ñæ';
      position:absolute;
      right:10px;
      top:50%;
      transform:translateY(-50%);
      color:var(--text);
      font-size:14px;
      pointer-events:none;
      user-select:none;
    }
    /* Attempt to keep options dark where browsers allow styling */
    .select-wrap select option {
      color: var(--text) !important;
      background: var(--card) !important;
    }
  </style>
</head>
<body class="has-site-layout">
  <header class="site-header" role="banner">
    <button class="menu-btn" aria-label="Open menu" type="button">‚ò∞</button>
    <a class="brand" href="dashboard.html" aria-label="Home">
      <img src="https://img1.wsimg.com/isteam/ip/e5c52ac6-7189-421d-9701-bbc6d6a027fc/SmartSelect_20241218_055052_Gallery.png" alt="logo" class="brand-logo" width="28" height="28">
      <span class="brand-name">925 ADHD</span>
    </a>
    <h2 class="title">Feedback</h2>
  </header>

  <nav class="site-nav">
    <div class="nav-items">
      <a href="dashboard.html" class="nav-item"><span class="icon">üè†</span><span>Home</span></a>
      <a href="guides.html" class="nav-item"><span class="icon">üìñ</span><span>Guides</span></a>
      <a href="earn.html" class="nav-item"><span class="icon">üí∞</span><span>Earn</span></a>
      <a href="apps.html" class="nav-item"><span class="icon">üì±</span><span>Apps</span></a>
      <a href="favorites.html" class="nav-item"><span class="icon">‚ù§Ô∏è</span><span>Saved</span></a>
      <a href="tools.html" class="nav-item"><span class="icon">üõ†Ô∏è</span><span>Tools</span></a>
    </div>
  </nav>

  <main class="main-content">
    <div class="wrap" aria-labelledby="pageTitle">
    <h1 id="pageTitle">Got an idea or found a bug?</h1>
    <p class="lead">Drop it here ‚Äî no email required. Your ideas shape what gets built next.</p>

    <form id="feedbackForm" novalidate>
      <label for="kind">What's this about?</label>
      <div class="select-wrap">
        <select id="kind" name="kind">
          <option value="feature">üí° Feature idea</option>
          <option value="bug">üêõ Bug report</option>
          <option value="other">üí¨ Other feedback</option>
        </select>
      </div>

      <label for="title">Quick summary</label>
      <input id="title" name="title" type="text" placeholder="What's the gist?" required>

      <label for="description">Tell me more</label>
      <textarea id="description" name="description" placeholder="Details, steps to reproduce, or just brain-dump your idea here..." required></textarea>

      <label for="screenshot">Screenshot (optional)</label>
      <input id="screenshot" name="screenshot" type="file" accept="image/*">

      <div class="checkbox-row">
        <input id="wantResponse" type="checkbox">
        <label for="wantResponse">I'd like a response</label>
      </div>

      <div id="emailSection" class="email-section hidden">
        <label for="email" style="margin-top:0">Your email</label>
        <input id="email" name="email" type="email" placeholder="you@example.com">
      </div>

      <div class="actions">
        <button type="submit">Send it ‚ú®</button>
        <div id="status" class="muted small" style="margin-top:8px;text-align:center" aria-live="polite"></div>
      </div>
    </form>

    <div id="result" class="notice hidden" role="status"></div>
    </div>
  </main>

  <script src="assets/layout.js"></script>
  <script>
    (function(){
      const form = document.getElementById('feedbackForm');
      const wantResponse = document.getElementById('wantResponse');
      const emailSection = document.getElementById('emailSection');
      const email = document.getElementById('email');
      const status = document.getElementById('status');
      const result = document.getElementById('result');

      // Toggle email field visibility
      wantResponse.addEventListener('change', function() {
        if (this.checked) {
          emailSection.classList.remove('hidden');
          email.focus();
        } else {
          emailSection.classList.add('hidden');
          email.value = '';
        }
      });

      function buildPayload() {
        const kind = document.getElementById('kind').value;
        const title = document.getElementById('title').value.trim();
        const description = document.getElementById('description').value.trim();
        const fileInput = document.getElementById('screenshot');
        const file = fileInput.files && fileInput.files[0];

        const payload = {
          createdAt: new Date().toISOString(),
          kind,
          title,
          description,
          anonymous: !wantResponse.checked
        };
        if (wantResponse.checked && email.value) {
          payload.email = email.value.trim();
        }
        if (file) {
          payload.attachmentName = file.name;
        }
        return { payload, file };
      }

      function showStatus(msg) {
        status.textContent = msg;
      }

      function showResult(msg, ok = true) {
        result.classList.remove('hidden');
        result.textContent = msg;
        result.style.background = ok ? 'rgba(86,195,174,.12)' : 'rgba(255,100,100,.12)';
      }

      form.addEventListener('submit', async (ev) => {
        ev.preventDefault();
        result.classList.add('hidden');

        const { payload, file } = buildPayload();

        if (!payload.title || !payload.description) {
          showStatus('Just need a summary and some details!');
          return;
        }

        if (wantResponse.checked && !email.value.trim()) {
          showStatus('Add your email so I can get back to you!');
          email.focus();
          return;
        }

        showStatus('Sending...');

        try {
          const endpoint = '/submit-feedback';
          const formData = new FormData();
          formData.append('payload', JSON.stringify(payload));
          if (file) formData.append('screenshot', file, file.name);

          const res = await fetch(endpoint, { method: 'POST', body: formData });

          if (res.ok) {
            showResult('Got it! Thanks for helping make this better. üíú');
            form.reset();
            emailSection.classList.add('hidden');
            showStatus('');
            return;
          }

          showStatus('Hmm, something went wrong. Try again?');
        } catch (err) {
          showStatus('Could not connect ‚Äî check your internet and try again.');
        }
      });

    })();
  </script>
</body>
</html>